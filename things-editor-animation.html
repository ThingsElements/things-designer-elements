<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../things-i18n-msg/things-i18n-msg.html">
<link rel="import" href="./things-editor-number-input.html">
<link rel="import" href="./things-editor-angle-input.html">
<link rel="import" href="./things-editor-value.html">

<!--
컴포넌트의 그림자를 주는 속성이다.

Example:

    <things-editor-animation value={{animation}}>
    </things-editor-animation>

@demo demo/index-editor-animation.html
@hero hero.svg
-->


<dom-module id="things-editor-animation">
  <template>
  <style>
    :host {
      display: block;
      @apply(--things-editor-animation)
    }
    paper-radio-button{padding:2px 1px 10px 7px !important;}
    .icon-only-label{
      @apply(--things-properties-icon-only-label);
      float:left;
      margin-top:2px;margin-left:40px;
    }
    .icon-only-label.color{background-position:70% -498px;}
    things-editor-color::animation #text{
      width:71%;
    }
    label{
      @apply(--things-label);
    }
    input{
      @apply(--things-input);
    }
    fieldset{
      @apply(--things-fieldset);
    }
    legend{
      @apply(--things-fieldset-legend);
    }
  </style>

    <label><things-i18n-msg msgid="label.delay" auto>지연</things-i18n-msg></label>
    <input is="things-editor-number-input" number="{{animation.delay::change}}" value="0">

    <template is='dom-if' if='[[_isRotation(value.type)]]'>
      <label><things-i18n-msg msgid="label.duration" auto>시간</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.duration::change}}" value="2000">

      <label><things-i18n-msg msgid="label.theta" auto>각도</things-i18n-msg></label>
      <input is="things-editor-angle-input" radian="{{animation.theta::change}}">

      <label><things-i18n-msg msgid="label.repeat" auto>반복</things-i18n-msg></label>
      <input type="checkbox" checked="{{animation.repeat::change}}"></input>
    </template>

    <template is='dom-if' if='[[_isVibration(value.type)]]'>
      <label><things-i18n-msg msgid="label.cycle" auto>주기</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.cycle::change}}" value="1000">

      <label><things-i18n-msg msgid="label.tilt" auto>기울기</things-i18n-msg></label>
      <input is="things-editor-angle-input" radian="{{animation.tilt::change}}">

      <label><things-i18n-msg msgid="label.repeat" auto>반복</things-i18n-msg></label>
      <input type="checkbox" checked="{{animation.repeat::change}}"></input>
    </template>

    <template is='dom-if' if='[[_isHeartbeat(value.type)]]'>
      <label><things-i18n-msg msgid="label.cycle" auto>주기</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.cycle::change}}" value="2000">

      <label><things-i18n-msg msgid="label.scale" auto>크기</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.scale::change}}" value="1.3">

      <label><things-i18n-msg msgid="label.repeat" auto>반복</things-i18n-msg></label>
      <input type="checkbox" checked="{{animation.repeat::change}}"></input>
    </template>

    <template is='dom-if' if='[[_isMoving(value.type)]]'>
      <label><things-i18n-msg msgid="label.duration" auto>시간</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.duration::change}}" value="2000">

      <label><things-i18n-msg msgid="label.x-axes" auto>X 축</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.x::change}}" value="100">

      <label><things-i18n-msg msgid="label.y-axes" auto>Y 축</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.y::change}}" value="0">

      <label><things-i18n-msg msgid="label.repeat" auto>반복</things-i18n-msg></label>
      <input type="checkbox" checked="{{animation.repeat::change}}"></input>
    </template>

    <template is='dom-if' if='[[_isOutline(value.type)]]'>
      <label><things-i18n-msg msgid="label.duration" auto>시간</things-i18n-msg></label>
      <input is="things-editor-number-input" number="{{animation.duration::change}}" value="2000">

      <label><things-i18n-msg msgid="label.target" auto>대상</things-i18n-msg></label>
      <input required value="{{animation.rideOn::change}}">

      <label><things-i18n-msg msgid="label.repeat" auto>반복</things-i18n-msg></label>
      <input type="checkbox" checked="{{animation.repeat::change}}"></input>
    </template>


  </template>

  <script>
  Polymer({
    is: 'things-editor-animation',

    properties: {
      value: {
        notify: true
      }
    },

    listeners: {
      'value-changed': 'onChangedValue'
    },

    observers: [
      'onChangedAnimation(animation.*)'
    ],

    onChangedValue: function(changed, after) {

      if(this.changedOnThis){
        return
      }

      var value = after.value

      if(!value){
        this.animation = {}
        return
      }

      this.animation = Object.assign({}, value);
    },

    onChangedAnimation: function(changed) {
      if(changed.path.indexOf('animation.') !== 0)
        return

      this.changedOnThis = true

      var prop = changed.path.substr(10)
      this.set('value.' + prop, changed.value)

      this.changedOnThis = false
    },

    _isOutline: function(type){
      return type == 'outline'
    },

    _isRotation: function(type){
      return type == 'rotation'
    },

    _isVibration: function(type){
      return type == 'vibration'
    },

    _isHeartbeat: function(type){
      return type == 'heartbeat'
    },

    _isMoving: function(type){
      return type == 'moving'
    }

  });
  </script>
</dom-module>
